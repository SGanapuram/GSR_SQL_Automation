SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
 
CREATE view [dbo].[v_allocation_all_rs]
(
   alloc_num,
   alloc_type_code,
   mot_code,
   sch_init,
   alloc_status,
   cmnt_num,
   ppl_comp_num,
   ppl_comp_cont_num,
   sch_prd,
   ppl_batch_num,
   ppl_pump_date,
   compr_trade_num,
   initiator_acct_num,
   deemed_bl_date,
   alloc_pay_date,
   alloc_base_price,
   alloc_disc_rate,
   transportation,
   netout_gross_qty,
   netout_net_qty,
   netout_qty_uom_code,
   ppl_batch_given_date,
   ppl_batch_received_date,
   ppl_origin_given_date,
   ppl_origin_received_date,
   ppl_timing_cycle_num,
   ppl_split_cycle_opt,
   alloc_short_cmnt,
   creation_type,
   netout_parcel_num,
   alloc_cmdty_code,
   bookout_pay_date,
   bookout_rec_date,
   alloc_match_ind,
   alloc_loc_code,
   alloc_begin_date,
   alloc_end_date,
   alloc_load_loc_code,
   book_net_price_ind,
   creation_date,
   multiple_cmdty_ind,
   price_precision,
   pay_for_del,
   pay_for_weight,
   max_alloc_item_num,
   voyage_code,
   trans_id,
   resp_trans_id,
   release_doc_num,
   bookout_brkr_num,
   base_port_num,
   transfer_price,
   transfer_price_uom_code,
   transfer_price_curr_code,
   transfer_price_curr_code_to,
   transfer_price_currency_rate,
   shipment_key,
   trans_type,
   trans_user_init,
   tran_date,
   app_name,
   workstation_id,
   sequence
)
as
select
   maintb.alloc_num,
   maintb.alloc_type_code,
   maintb.mot_code,
   maintb.sch_init,
   maintb.alloc_status,
   maintb.cmnt_num,
   maintb.ppl_comp_num,
   maintb.ppl_comp_cont_num,
   maintb.sch_prd,
   maintb.ppl_batch_num,
   maintb.ppl_pump_date,
   maintb.compr_trade_num,
   maintb.initiator_acct_num,
   maintb.deemed_bl_date,
   maintb.alloc_pay_date,
   maintb.alloc_base_price,
   maintb.alloc_disc_rate,
   maintb.transportation,
   maintb.netout_gross_qty,
   maintb.netout_net_qty,
   maintb.netout_qty_uom_code,
   maintb.ppl_batch_given_date,
   maintb.ppl_batch_received_date,
   maintb.ppl_origin_given_date,
   maintb.ppl_origin_received_date,
   maintb.ppl_timing_cycle_num,
   maintb.ppl_split_cycle_opt,
   maintb.alloc_short_cmnt,
   maintb.creation_type,
   maintb.netout_parcel_num,
   maintb.alloc_cmdty_code,
   maintb.bookout_pay_date,
   maintb.bookout_rec_date,
   maintb.alloc_match_ind,
   maintb.alloc_loc_code,
   maintb.alloc_begin_date,
   maintb.alloc_end_date,
   maintb.alloc_load_loc_code,
   maintb.book_net_price_ind,
   maintb.creation_date,
   maintb.multiple_cmdty_ind,
   maintb.price_precision,
   maintb.pay_for_del,
   maintb.pay_for_weight,
   maintb.max_alloc_item_num,
   maintb.voyage_code,
   maintb.trans_id,
   null,
   maintb.release_doc_num,
   maintb.bookout_brkr_num,
   maintb.base_port_num,
   maintb.transfer_price,
   maintb.transfer_price_uom_code,
   maintb.transfer_price_curr_code,
   maintb.transfer_price_curr_code_to,
   maintb.transfer_price_currency_rate,
   maintb.shipment_key,
   it.type,
   it.user_init,
   it.tran_date,
   it.app_name,
   it.workstation_id,
   it.sequence
from dbo.allocation maintb
        left outer join dbo.icts_transaction it
           on maintb.trans_id = it.trans_id
union
select
   audtb.alloc_num,
   audtb.alloc_type_code,
   audtb.mot_code,
   audtb.sch_init,
   audtb.alloc_status,
   audtb.cmnt_num,
   audtb.ppl_comp_num,
   audtb.ppl_comp_cont_num,
   audtb.sch_prd,
   audtb.ppl_batch_num,
   audtb.ppl_pump_date,
   audtb.compr_trade_num,
   audtb.initiator_acct_num,
   audtb.deemed_bl_date,
   audtb.alloc_pay_date,
   audtb.alloc_base_price,
   audtb.alloc_disc_rate,
   audtb.transportation,
   audtb.netout_gross_qty,
   audtb.netout_net_qty,
   audtb.netout_qty_uom_code,
   audtb.ppl_batch_given_date,
   audtb.ppl_batch_received_date,
   audtb.ppl_origin_given_date,
   audtb.ppl_origin_received_date,
   audtb.ppl_timing_cycle_num,
   audtb.ppl_split_cycle_opt,
   audtb.alloc_short_cmnt,
   audtb.creation_type,
   audtb.netout_parcel_num,
   audtb.alloc_cmdty_code,
   audtb.bookout_pay_date,
   audtb.bookout_rec_date,
   audtb.alloc_match_ind,
   audtb.alloc_loc_code,
   audtb.alloc_begin_date,
   audtb.alloc_end_date,
   audtb.alloc_load_loc_code,
   audtb.book_net_price_ind,
   audtb.creation_date,
   audtb.multiple_cmdty_ind,
   audtb.price_precision,
   audtb.pay_for_del,
   audtb.pay_for_weight,
   audtb.max_alloc_item_num,
   audtb.voyage_code,
   audtb.trans_id,
   audtb.resp_trans_id,
   audtb.release_doc_num,
   audtb.bookout_brkr_num,
   audtb.base_port_num,
   audtb.transfer_price,
   audtb.transfer_price_uom_code,
   audtb.transfer_price_curr_code,
   audtb.transfer_price_curr_code_to,
   audtb.transfer_price_currency_rate,
   audtb.shipment_key,
   it.type,
   it.user_init,
   it.tran_date,
   it.app_name,
   it.workstation_id,
   it.sequence
from dbo.aud_allocation audtb
        left outer join dbo.icts_transaction it
           on audtb.trans_id = it.trans_id
GO
GRANT SELECT ON  [dbo].[v_allocation_all_rs] TO [admin_group]
GO
GRANT SELECT ON  [dbo].[v_allocation_all_rs] TO [next_usr]
GO
