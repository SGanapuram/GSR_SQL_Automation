SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO

CREATE view [dbo].[v_trade_all_rs]
(
   trade_num,
   trader_init,
   trade_status_code,
   conclusion_type,
   inhouse_ind,
   acct_num,
   acct_cont_num,
   acct_short_name,
   acct_ref_num,
   port_num,
   concluded_date,
   contr_approv_type,
   contr_date,
   cr_anly_init,
   credit_term_code,
   cp_gov_contr_ind,
   contr_exch_method,
   contr_cnfrm_method,
   contr_tlx_hold_ind,
   creation_date,
   creator_init,
   trade_mod_date,
   trade_mod_init,
   invoice_cap_type,
   internal_agreement_ind,
   credit_status,
   credit_res_exp_date,
   contr_anly_init,
   contr_status_code,
   max_order_num,
   is_long_term_ind,
   special_contract_num,
   cargo_id_number,
   internal_parent_trade_num,
   copy_type,
   product_id,
   econfirm_status,
   external_trade_type,
   resp_trans_id,
   trans_id,
   trans_type,
   trans_user_init,
   tran_date,
   app_name,
   workstation_id,
   sequence,
   inv_pricing_type,
   exch_memo_code,
   no_of_forward_months,
   no_del_draw_price_ind,
   use_mtm,
   inventory_type
)
as
select
   t.trade_num,
   t.trader_init,
   t.trade_status_code,
   t.conclusion_type,
   t.inhouse_ind,
   t.acct_num,
   t.acct_cont_num,
   t.acct_short_name,
   t.acct_ref_num,
   t.port_num,
   t.concluded_date,
   t.contr_approv_type,
   t.contr_date,
   t.cr_anly_init,
   t.credit_term_code,
   t.cp_gov_contr_ind,
   t.contr_exch_method,
   t.contr_cnfrm_method,
   t.contr_tlx_hold_ind,
   t.creation_date,
   t.creator_init,
   t.trade_mod_date,
   t.trade_mod_init,
   t.invoice_cap_type,
   t.internal_agreement_ind,
   t.credit_status,
   t.credit_res_exp_date,
   t.contr_anly_init,
   t.contr_status_code,
   t.max_order_num,
   t.is_long_term_ind,
   t.special_contract_num,
   t.cargo_id_number,
   t.internal_parent_trade_num,
   t.copy_type,
   t.product_id,
   t.econfirm_status,
   t.external_trade_type,
   null,
   t.trans_id,
   it.type,
   it.user_init,
   it.tran_date,
   it.app_name,
   it.workstation_id,
   it.sequence,
   t.inv_pricing_type,
   t.exch_memo_code,
   t.no_of_forward_months,
   t.no_del_draw_price_ind,
   t.use_mtm,
   t.inventory_type
from dbo.trade t
        left outer join dbo.icts_transaction it
           on t.trans_id = it.trans_id
union
select
   t.trade_num,
   t.trader_init,
   t.trade_status_code,
   t.conclusion_type,
   t.inhouse_ind,
   t.acct_num,
   t.acct_cont_num,
   t.acct_short_name,
   t.acct_ref_num,
   t.port_num,
   t.concluded_date,
   t.contr_approv_type,
   t.contr_date,
   t.cr_anly_init,
   t.credit_term_code,
   t.cp_gov_contr_ind,
   t.contr_exch_method,
   t.contr_cnfrm_method,
   t.contr_tlx_hold_ind,
   t.creation_date,
   t.creator_init,
   t.trade_mod_date,
   t.trade_mod_init,
   t.invoice_cap_type,
   t.internal_agreement_ind,
   t.credit_status,
   t.credit_res_exp_date,
   t.contr_anly_init,
   t.contr_status_code,
   t.max_order_num,
   t.is_long_term_ind,
   t.special_contract_num,
   t.cargo_id_number,
   t.internal_parent_trade_num,
   t.copy_type,
   t.product_id,
   t.econfirm_status,
   t.external_trade_type,
   t.resp_trans_id,
   t.trans_id,
   it.type,
   it.user_init,
   it.tran_date,
   it.app_name,
   it.workstation_id,
   it.sequence,
   t.inv_pricing_type,
   t.exch_memo_code,
   t.no_of_forward_months,
   t.no_del_draw_price_ind,
   t.use_mtm,
   t.inventory_type
from dbo.aud_trade t
        left outer join dbo.icts_transaction it
           on t.trans_id = it.trans_id
GO
GRANT SELECT ON  [dbo].[v_trade_all_rs] TO [next_usr]
GO
GRANT SELECT ON  [dbo].[v_trade_all_rs] TO [public]
GO
